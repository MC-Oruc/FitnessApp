import React, { useRef } from 'react';
import { View, StyleSheet, Animated } from 'react-native';
import Svg, { Path, G, Image as SvgImage } from 'react-native-svg';

type AnatomyRegion = {
  keyword: string;
  label: string;
};

type Props = {
  onSelectRegion?: (region: AnatomyRegion) => void;
  detailMode?: 'simple' | 'detailed';
};

type MuscleGroupProps = {
  paths: string[];
  fill: string;
  fillActive: string;
  onPress: () => void;
};

const AnimatedPath = Animated.createAnimatedComponent(Path);

// PNG tabanı, Inkscape dosyasında (assets/anatomy/front/base_front.svg) kullanılan görselle aynıdır.
const FRONT_BASE = require('../../assets/anatomy/front/base_front.png');

// Paths exported from Inkscape overlay (viewBox 0 0 1246 2415)
// Chest (Upper + Middle & Lower)
const PATHS_CHEST = [
  // middle_lower_chest_2
  'm 584.20046,522.2852 -12.98223,42.94123 -3.99454,15.97813 -3.99453,23.46788 2.49658,33.95353 8.48839,17.9754 30.95763,13.98087 33.45421,6.99043 28.46105,1.49795 32.45558,-0.99863 29.45968,-10.98497 30.45832,-21.47062 30.45831,-25.96446 41.44328,-37.94806 -2.9959,-10.98497 -19.97266,-16.47745 -30.95764,-14.9795 -68.90569,-18.97403 -96.86743,-16.47745 h -20.47198 z',
  // middle_lower_chest_1
  'm 540.26059,637.12802 5.49249,-21.47061 17.9754,-106.35445 -70.40365,-2.9959 -67.90706,20.47199 -36.94943,24.96583 -7.85869,22.7003 5.64912,30.7171 13.0636,38.48465 9.35636,20.83114 17.65351,10.76864 16.77083,2.82456 28.95176,-4.58991 47.3114,-17.47697 z',
  // upper_chest_2
  'm 591.44055,503.56082 9.98633,-18.47471 14.72984,-12.98223 24.21686,-10.48565 45.18816,-11.23463 48.93302,-4.49385 31.70661,-4.49385 4.74351,6.24146 -1.74761,8.23872 1.24829,7.73941 3.24556,12.98223 9.98633,14.48019 46.43645,54.42551 7.48975,6.99043 7.48975,11.23463 15.97813,12.48291 7.73941,10.98497 3.24556,7.24009 -16.72711,-6.74077 -15.72847,-3.99454 -8.23873,-1.99726 -3.74487,-11.73395 -20.47199,-16.47744 -30.95763,-14.72984 -68.65603,-18.97404 -96.86743,-15.72847 z',
  // upper_chest_1
  'm 388.55373,551.31908 11.82785,-19.94846 13.41667,-16.0647 3.35416,-9.88596 24.89145,-27.53948 11.65132,-22.59649 6.70833,-2.11842 13.24013,1.05921 9.35636,3.5307 4.76645,1.58882 45.36952,0.17653 18.71272,2.29496 10.76864,6.00219 3.85739,4.78521 0.24966,25.21549 -0.24966,5.49248 -2.74624,5.74215 -70.15399,-2.49659 -68.65604,20.47198 z',
];

// Shoulders (front + lateral)
const PATHS_SHOULDERS = [
  // front_shoulder_1
  'm 770.69522,447.88702 -1.49795,7.98906 4.99317,20.9713 41.44328,51.17996 22.21959,23.9672 7.48975,11.9836 14.72984,10.98496 13.23189,19.97267 34.7025,20.22232 -0.49931,-12.73257 -16.22779,-75.14716 -6.49112,-19.723 -27.96173,-49.93167 -12.48292,-13.98086 -22.46924,-12.48292 -25.71481,0.24966 L 767.2,441.64556 Z',
  // front_shoulder_2
  'm 459.87062,453.12984 -4.49385,-4.99316 -15.47882,-1.74761 -8.23872,-9.73668 -21.47062,5.24283 -19.47335,10.73531 -17.47608,14.72984 -14.23052,17.47608 -9.23736,16.47745 -6.74077,16.97676 -5.74215,23.21823 -3.49521,26.21412 0.74897,36.20046 4.49385,20.47198 2.24693,15.47881 7.24009,-12.48291 23.21822,-25.71481 9.98633,-18.72437 -1.24829,-8.23873 7.73941,-23.9672 11.48428,-19.47334 13.98087,-15.97814 3.99453,-10.98496 21.47062,-23.71754 2.9959,-2.74624 11.23462,-22.21959 z',
  // side_shoulder_1 (lateral area)
  'm 908.09649,615.04825 9.5329,13.06359 19.41886,33.89474 3.88377,1.41228 -1.41228,-23.30263 12.35745,-13.76974 12.00439,-19.77193 7.41447,-12.00438 1.41228,-40.60307 -7.76754,-36.01316 -20.125,-43.07456 -19.06579,-24.36185 -28.24561,-18.71271 -33.89474,-10.94518 -11.29825,-2.82456 -12.00438,7.0614 -18.35965,6.35527 21.53728,11.65131 11.65132,11.65132 30.36403,53.66666 5.29605,18.00658 8.82676,38.48465 6.70833,33.1886 z',
];

// Abs
const PATHS_ABS = [
  // upper_abs_1
  'm 570.21959,671.7057 10.48565,3.8697 31.20729,9.48702 26.46378,7.73941 4.99317,4.7435 5.24282,14.48019 2.24693,15.97813 v 14.9795 l -3.74488,11.48428 -7.98906,9.73667 -1.99727,8.73805 7.73941,9.98633 3.49522,6.74077 3.24555,13.98087 v 13.48155 l 0.24966,15.97813 -6.24146,11.73394 -17.47608,3.49522 -12.98223,0.74897 -22.71891,-3.99453 -17.72574,0.74897 -30.70797,-0.24965 -16.47745,2.24692 -18.22506,1.24829 -18.47471,2.24693 -10.98497,-0.49932 -9.73667,-22.71891 -0.99863,-10.98496 -1.74761,-14.48018 0.74898,-15.66607 -1.2483,-27.52482 -3.24556,-4.99317 -1.74761,-31.95626 5.24283,-16.72711 7.98906,-10.98497 8.23873,-6.24146 40.19499,-17.22642 10.23599,1.24829 14.48018,0.37449 z',
  // lower_abs_1
  'm 574.46378,855.70388 c 0.87381,0 58.66971,2.74624 58.66971,2.74624 l 7.11526,4.24419 9.84171,11.50745 2.47149,7.0614 0.35307,12.18092 -1.41228,18.80099 -1.50055,8.12061 -10.0625,21.09595 -0.35307,21.53728 5.47259,12.18092 0.79441,16.15296 -1.76535,17.56521 -4.67818,31.9529 -19.06579,73.7916 -27.53947,48.3707 -22.24343,-8.1207 -16.94736,12.3575 -22.94957,-30.7171 -4.23684,-23.3026 -30.7171,-76.6163 -9.5329,-50.489 -0.70614,-28.95175 0.70614,-19.77193 -8.47368,-16.94737 -3.5307,-36.36623 1.76535,-13.41667 8.82675,-10.23903 53.66667,-2.82456 z',
];

// Obliques
const PATHS_OBLIQUES = [
  // obliques_2
  'm 652.47369,1022.8443 31.07017,7.7675 47.66447,-30.71706 28.24562,-25.77412 28.95175,-19.41886 7.41448,-4.94299 -0.35307,-30.7171 -3.88378,-39.54386 5.64913,-34.60088 1.41228,-22.24342 -19.41886,5.29605 -4.58991,-0.35307 -2.11842,-4.23684 2.11842,-6.35526 0.70614,-21.53728 -6.35527,-4.58992 4.23685,-18.35964 6.70833,-11.29825 2.47149,-3.88377 -15.18202,3.17763 -13.06359,-6.70833 7.76754,-13.76974 5.29605,-14.12281 -12.00438,-5.64912 -25.77413,0.35307 17.65351,-21.89035 14.47588,-14.12281 -31.77632,-5.64912 -9.53289,-8.12062 -35.66009,12.00439 -20.47807,12.35746 -3.88377,7.0614 1.76535,19.41886 1.41228,10.94518 -3.17763,15.88815 -6.35526,14.47588 4.58991,7.76754 5.29605,16.5943 -1.41228,49.42983 3.88377,20.83114 -5.29605,60.72807 -9.5329,72.02631 z',
  // obliques_1
  'm 410.62061,669.77412 18.71272,9.17983 25.06799,0.35307 7.76754,-1.41228 -6.70833,12.71052 -1.76535,18.35965 -4.58992,18.00658 5.64913,13.76974 0.35307,36.7193 4.23684,32.83552 8.82675,44.48685 7.41448,82.61842 2.47149,42.01535 -1.05921,25.42103 3.88377,13.0636 9.17982,15.8882 -33.18859,-4.943 -21.89035,-23.6557 -7.06141,-30.71711 -0.35307,-26.83334 5.64913,-35.30702 3.88377,-32.83552 -1.76535,-32.48246 -7.76755,-38.83772 -6.70833,-54.3728 -10.94518,-70.26097 z',
];

// Triceps (Lateral & Medial head)
const PATHS_TRICEPS = [
  'm 971.29605,595.62939 1.41228,6.70833 13.41667,23.6557 10.94518,32.83553 3.17762,26.12719 4.943,59.31579 4.5899,22.94956 11.2982,36.7193 -26.48021,-33.89474 -30.71711,-38.48465 -16.24123,-51.90131 -6.35526,-16.94737 -1.76535,-22.59649 14.82895,-16.24123 12.35745,-20.83114 z',
];

// Biceps (Long + Short head + Brachioradialis)
const PATHS_BICEPS = [
  // short_head_2
  'm 950.81798,849.83991 -1.76535,31.42325 -17.65351,-32.12939 -30.7171,-24.00877 -22.94956,-32.48245 -22.59649,-47.31141 -19.41886,-67.4364 -6.0022,-32.48246 -8.47368,-54.01974 9.88596,-9.53289 12.71053,3.17763 6.00219,33.54167 4.58992,20.47807 12.00438,39.19079 22.24342,70.26096 20.125,37.77851 19.41886,27.89255 z',
  // short_head_1
  'm 344.24342,873.84869 32.83553,-25.06799 21.18421,-33.18859 20.83114,-66.73027 -10.23904,-74.14473 -0.35307,-8.82676 -10.23903,-25.06798 -13.0636,-36.7193 -14.82895,44.48684 -12.35745,40.60307 -9.5329,69.55483 -6.00219,49.42982 -1.05921,46.2522 z',
  // long_head_2
  'm 940.93202,663.77193 10.5921,28.24561 8.82676,31.07018 2.11842,8.47368 3.17763,20.125 -0.70614,24.71492 -7.41447,43.42763 -6.0022,30.01096 -19.06579,-30.7171 -24.71491,-34.24781 -17.65351,-32.48245 -18.35965,-58.60965 -17.6535,-55.07895 -7.76755,-37.07237 -2.47149,-17.65351 27.89254,10.94518 25.77413,13.76973 c 0,0 12.00438,6.70834 12.71052,8.12062 0.70614,1.41228 30.71711,46.95833 30.71711,46.95833 z',
  // long_head_1
  'm 307.17105,769.69298 5.64913,23.65571 17.30043,34.2478 10.59211,26.1272 2.11842,-49.7829 11.65132,-86.14912 3.17763,-29.6579 27.1864,-84.38377 -3.17763,-20.125 -8.82675,16.94737 -24.00878,25.77412 -7.76754,13.76974 -11.65132,23.30263 -9.53289,31.77632 -6.35526,33.54166 z',
  // brachioradialis_1
  'm 948.34649,881.9693 -5.29605,42.36842 25.06798,155.70398 10.94518,-62.1404 11.65131,-64.25875 16.24119,-54.37281 2.8246,-38.13158 -3.5307,-55.07895 -8.82675,-33.54166 -34.24781,-40.60308 2.82456,28.95176 -4.94298,44.83991 -10.23904,43.42763 z',
  // brachioradialis_2
  'm 306.81798,773.22369 7.76755,24.71491 15.18201,29.65789 11.29825,27.53948 1.05921,14.82894 -26.48026,32.48246 -9.5329,48.37061 -50.48903,105.56802 -18.35965,10.5921 -15.18202,3.5307 13.41667,-56.1382 7.0614,-41.66227 8.82676,-68.49561 10.5921,-39.19079 17.30044,-34.95395 19.41886,-31.77631 z',
];

// Forearms (Flexors + Extensors)
const PATHS_FOREARMS = [
  // flexors_1
  'm 257.03509,1056.386 36.7193,55.7851 26.12719,-50.8422 40.95614,-61.0811 13.0636,-20.83113 19.41886,-49.7829 9.17982,-41.66228 2.82456,-22.94956 -26.83333,-16.24123 -34.24781,24.00878 -28.95175,29.30482 -9.88597,50.48903 z',
  // flexors_2
  'm 898.21053,825.125 30.7171,22.59649 19.41886,32.12939 -5.64912,43.07456 25.77412,156.41006 -2.47149,31.4233 -11.29824,-1.4123 -11.65132,-55.079 -22.59649,-71.32013 -11.29825,-35.66009 -5.29605,-68.14254 z',
  // extensors_1
  'm 967.76535,1077.9232 15.18202,47.6645 57.55043,6.3553 0.3531,-64.9649 11.6513,-99.91889 v -40.25 l -7.0614,-40.95614 -9.886,-41.66228 -13.0636,-38.83772 -23.65567,-28.95175 7.76757,28.95175 2.4715,35.66009 v 36.36623 l -1.4123,22.59649 -16.24125,50.8421 z',
];

// Upper Trapezius (front view)
const PATHS_TRAPS = [
  // upper_trap_2
  'm 835.36404,414.50439 -38.48465,-28.95176 -55.43202,-29.65789 -20.83114,-14.12281 -10.94518,-16.94737 -6.70833,-23.6557 -1.41228,-22.94956 -9.17982,28.24561 -13.0636,43.42763 -16.5943,38.48465 -32.12939,55.43202 53.3136,-11.29824 63.19956,-4.94299 34.95395,-8.12061 z',
  // upper_trap_1
  'm 455.46053,429.6864 34.60087,9.88597 75.20395,5.64912 -4.94298,-30.36403 -10.23904,-47.31141 -25.77412,23.65571 -34.24781,22.24342 z',
];

// Calves (front / Tibialis Anterior region)
const PATHS_CALVES = [
  // tibialis_anterior_2
  'm 741.0943,1728.2785 c -0.35307,1.4123 -6.70833,82.2654 -6.70833,82.2654 l 2.82456,58.6096 7.76754,27.1864 18.71272,37.4255 22.24342,85.4429 6.00219,44.1338 -0.70614,70.9671 38.48465,14.4759 49.07676,-17.3004 5.64912,-74.4979 14.47588,-100.978 16.5943,-87.2084 1.41228,-59.3157 -5.29606,-28.9518 -21.53728,-61.4342 -24.36184,-47.3114 -37.42544,-23.6557 -26.48026,21.8903 -18.00658,47.6645 -30.7171,-26.1272 z',
  // tibialis_anterior_1
  'm 448.04605,1669.3158 28.95176,15.5351 25.77412,-19.0658 77.67544,-7.0614 6.00219,32.8355 17.30044,70.261 7.41447,33.8947 3.17764,33.1886 -1.76535,37.7785 -21.89036,50.4891 -6.70833,88.2675 -2.47149,114.7478 4.94298,31.0702 -50.48903,-15.8882 -28.24562,-9.1798 -17.30044,3.1776 -11.29824,-112.9824 -25.42105,-120.0439 -10.23904,-52.2544 -2.47149,-69.5548 2.47149,-48.7237 z',
];

// Quadriceps (Rectus Femoris + Vastus Group)
const PATHS_QUADRICEPS = [
  // rectus_femoris_2
  'm 718.49781,1088.1623 -10.59211,48.7237 -22.94956,109.4517 -5.64912,49.0768 0.70614,21.1842 14.12281,57.5504 20.47807,64.6119 17.30043,43.0745 2.82457,13.4167 8.82675,-3.5307 8.82676,5.6491 -1.76536,-20.4781 6.35527,-79.7938 9.17982,-86.5022 2.82456,-45.5461 -8.12061,-50.489 -26.48026,-68.1425 z',
  // rectus_femoris_1
  'm 461.86788,1499.9472 0.49932,-73.3996 1.99727,-43.4405 4.49385,-54.4255 14.48018,-64.9112 -18.97403,-82.3873 -14.9795,-95.8687 -10.98497,14.9795 -34.95216,85.8824 -6.99044,72.9002 8.9877,86.8811 26.9631,96.8675 z',
  // vastus_group_2
  'm 437.80702,1559.864 12.71052,-31.7763 -2.11842,-52.2544 -15.71162,-32.3059 -27.00987,-96.7412 -9.53289,-88.091 7.59101,-73.9682 34.95394,-85.443 10.23904,-13.9463 16.06469,97.977 18.34508,80.0812 -13.73121,63.7877 -6.99043,99.364 -0.49932,72.9002 16.29255,61.4754 21.89035,36.0132 16.5943,17.6535 21.18421,-8.4737 11.16934,-11.2989 40.19499,21.97 2.9959,-47.9344 0.24966,-54.9249 20.47198,-103.3585 9.73668,-58.9194 -1.24829,-47.4351 -8.48839,-56.1731 -13.48155,-30.708 c 0,0 -9.48701,3.4953 -11.23462,2.9959 -1.74761,-0.4993 -16.22779,-6.9904 -16.22779,-6.9904 l -16.47745,-20.2223 -14.48018,-32.7052 -20.9713,-33.4543 -56.9221,-67.158 -22.7189,-27.2128 -8.73804,-13.7312 -16.22779,47.4351 -15.47882,101.8606 -14.9795,85.8824 -2.24692,59.918 1.24829,59.4187 12.23326,78.6424 16.22779,50.6806 z',
  // vastus_group_1
  'm 768.07381,1532.5276 -12.98223,-19.5982 -2.87107,-15.7285 -1.62278,-20.9713 3.8697,-46.6861 4.74351,-56.7973 6.24146,-55.2993 3.49521,-52.6779 -8.23872,-50.9303 -26.21412,-66.6587 -15.85331,-58.6697 -30.33348,141.4314 -8.23873,53.9262 v 32.4556 l 14.72984,58.7945 19.97267,63.7877 17.47608,42.6916 2.74624,13.7312 1.51031,58.8864 -7.06141,57.1974 -14.82894,5.6491 -27.89255,-28.9517 -13.76973,-36.0132 -12.71053,-52.9605 -3.88377,-45.193 -11.29825,-52.2544 -22.59649,-96.7412 -9.35636,-58.6097 -2.47149,-38.3081 -2.11842,-37.0724 11.65131,-29.6579 33.1886,-40.4265 30.54057,-42.3684 33.89474,-28.0691 49.07675,-37.95504 27.85641,-27.92536 5.118,10.6729 10.10015,24.8435 11.65132,35.307 10.76864,49.2533 5.82566,47.3114 4.76645,58.08 0.17653,22.42 12.19781,65.8076 5.80877,61.4742 0.88268,56.3147 -3.35417,57.5504 -8.29715,74.8509 -11.01826,45.9045 -26.9631,22.4693 -31.95627,-27.9617 z',
];

// ==================== DETAILED MODE PATHS ====================

// Chest - Upper only
const PATHS_UPPER_CHEST = [
  'm 591.44055,503.56082 9.98633,-18.47471 14.72984,-12.98223 24.21686,-10.48565 45.18816,-11.23463 48.93302,-4.49385 31.70661,-4.49385 4.74351,6.24146 -1.74761,8.23872 1.24829,7.73941 3.24556,12.98223 9.98633,14.48019 46.43645,54.42551 7.48975,6.99043 7.48975,11.23463 15.97813,12.48291 7.73941,10.98497 3.24556,7.24009 -16.72711,-6.74077 -15.72847,-3.99454 -8.23873,-1.99726 -3.74487,-11.73395 -20.47199,-16.47744 -30.95763,-14.72984 -68.65603,-18.97404 -96.86743,-15.72847 z',
  'm 388.55373,551.31908 11.82785,-19.94846 13.41667,-16.0647 3.35416,-9.88596 24.89145,-27.53948 11.65132,-22.59649 6.70833,-2.11842 13.24013,1.05921 9.35636,3.5307 4.76645,1.58882 45.36952,0.17653 18.71272,2.29496 10.76864,6.00219 3.85739,4.78521 0.24966,25.21549 -0.24966,5.49248 -2.74624,5.74215 -70.15399,-2.49659 -68.65604,20.47198 z',
];

// Chest - Middle & Lower
const PATHS_MIDDLE_LOWER_CHEST = [
  'm 584.20046,522.2852 -12.98223,42.94123 -3.99454,15.97813 -3.99453,23.46788 2.49658,33.95353 8.48839,17.9754 30.95763,13.98087 33.45421,6.99043 28.46105,1.49795 32.45558,-0.99863 29.45968,-10.98497 30.45832,-21.47062 30.45831,-25.96446 41.44328,-37.94806 -2.9959,-10.98497 -19.97266,-16.47745 -30.95764,-14.9795 -68.90569,-18.97403 -96.86743,-16.47745 h -20.47198 z',
  'm 540.26059,637.12802 5.49249,-21.47061 17.9754,-106.35445 -70.40365,-2.9959 -67.90706,20.47199 -36.94943,24.96583 -7.85869,22.7003 5.64912,30.7171 13.0636,38.48465 9.35636,20.83114 17.65351,10.76864 16.77083,2.82456 28.95176,-4.58991 47.3114,-17.47697 z',
];

// Shoulders - Front only
const PATHS_FRONT_SHOULDER = [
  'm 770.69522,447.88702 -1.49795,7.98906 4.99317,20.9713 41.44328,51.17996 22.21959,23.9672 7.48975,11.9836 14.72984,10.98496 13.23189,19.97267 34.7025,20.22232 -0.49931,-12.73257 -16.22779,-75.14716 -6.49112,-19.723 -27.96173,-49.93167 -12.48292,-13.98086 -22.46924,-12.48292 -25.71481,0.24966 L 767.2,441.64556 Z',
  'm 459.87062,453.12984 -4.49385,-4.99316 -15.47882,-1.74761 -8.23872,-9.73668 -21.47062,5.24283 -19.47335,10.73531 -17.47608,14.72984 -14.23052,17.47608 -9.23736,16.47745 -6.74077,16.97676 -5.74215,23.21823 -3.49521,26.21412 0.74897,36.20046 4.49385,20.47198 2.24693,15.47881 7.24009,-12.48291 23.21822,-25.71481 9.98633,-18.72437 -1.24829,-8.23873 7.73941,-23.9672 11.48428,-19.47334 13.98087,-15.97814 3.99453,-10.98496 21.47062,-23.71754 2.9959,-2.74624 11.23462,-22.21959 z',
];

// Shoulders - Lateral only
const PATHS_LATERAL_SHOULDER = [
  'm 908.09649,615.04825 9.5329,13.06359 19.41886,33.89474 3.88377,1.41228 -1.41228,-23.30263 12.35745,-13.76974 12.00439,-19.77193 7.41447,-12.00438 1.41228,-40.60307 -7.76754,-36.01316 -20.125,-43.07456 -19.06579,-24.36185 -28.24561,-18.71271 -33.89474,-10.94518 -11.29825,-2.82456 -12.00438,7.0614 -18.35965,6.35527 21.53728,11.65131 11.65132,11.65132 30.36403,53.66666 5.29605,18.00658 8.82676,38.48465 6.70833,33.1886 z',
];

// Abs - Upper only
const PATHS_UPPER_ABS = [
  'm 570.21959,671.7057 10.48565,3.8697 31.20729,9.48702 26.46378,7.73941 4.99317,4.7435 5.24282,14.48019 2.24693,15.97813 v 14.9795 l -3.74488,11.48428 -7.98906,9.73667 -1.99727,8.73805 7.73941,9.98633 3.49522,6.74077 3.24555,13.98087 v 13.48155 l 0.24966,15.97813 -6.24146,11.73394 -17.47608,3.49522 -12.98223,0.74897 -22.71891,-3.99453 -17.72574,0.74897 -30.70797,-0.24965 -16.47745,2.24692 -18.22506,1.24829 -18.47471,2.24693 -10.98497,-0.49932 -9.73667,-22.71891 -0.99863,-10.98496 -1.74761,-14.48018 0.74898,-15.66607 -1.2483,-27.52482 -3.24556,-4.99317 -1.74761,-31.95626 5.24283,-16.72711 7.98906,-10.98497 8.23873,-6.24146 40.19499,-17.22642 10.23599,1.24829 14.48018,0.37449 z',
];

// Abs - Lower only
const PATHS_LOWER_ABS = [
  'm 574.46378,855.70388 c 0.87381,0 58.66971,2.74624 58.66971,2.74624 l 7.11526,4.24419 9.84171,11.50745 2.47149,7.0614 0.35307,12.18092 -1.41228,18.80099 -1.50055,8.12061 -10.0625,21.09595 -0.35307,21.53728 5.47259,12.18092 0.79441,16.15296 -1.76535,17.56521 -4.67818,31.9529 -19.06579,73.7916 -27.53947,48.3707 -22.24343,-8.1207 -16.94736,12.3575 -22.94957,-30.7171 -4.23684,-23.3026 -30.7171,-76.6163 -9.5329,-50.489 -0.70614,-28.95175 0.70614,-19.77193 -8.47368,-16.94737 -3.5307,-36.36623 1.76535,-13.41667 8.82675,-10.23903 53.66667,-2.82456 z',
];

// Biceps - Long Head
const PATHS_BICEPS_LONG = [
  'm 940.93202,663.77193 10.5921,28.24561 8.82676,31.07018 2.11842,8.47368 3.17763,20.125 -0.70614,24.71492 -7.41447,43.42763 -6.0022,30.01096 -19.06579,-30.7171 -24.71491,-34.24781 -17.65351,-32.48245 -18.35965,-58.60965 -17.6535,-55.07895 -7.76755,-37.07237 -2.47149,-17.65351 27.89254,10.94518 25.77413,13.76973 c 0,0 12.00438,6.70834 12.71052,8.12062 0.70614,1.41228 30.71711,46.95833 30.71711,46.95833 z',
  'm 307.17105,769.69298 5.64913,23.65571 17.30043,34.2478 10.59211,26.1272 2.11842,-49.7829 11.65132,-86.14912 3.17763,-29.6579 27.1864,-84.38377 -3.17763,-20.125 -8.82675,16.94737 -24.00878,25.77412 -7.76754,13.76974 -11.65132,23.30263 -9.53289,31.77632 -6.35526,33.54166 z',
];

// Biceps - Short Head
const PATHS_BICEPS_SHORT = [
  'm 950.81798,849.83991 -1.76535,31.42325 -17.65351,-32.12939 -30.7171,-24.00877 -22.94956,-32.48245 -22.59649,-47.31141 -19.41886,-67.4364 -6.0022,-32.48246 -8.47368,-54.01974 9.88596,-9.53289 12.71053,3.17763 6.00219,33.54167 4.58992,20.47807 12.00438,39.19079 22.24342,70.26096 20.125,37.77851 19.41886,27.89255 z',
  'm 344.24342,873.84869 32.83553,-25.06799 21.18421,-33.18859 20.83114,-66.73027 -10.23904,-74.14473 -0.35307,-8.82676 -10.23903,-25.06798 -13.0636,-36.7193 -14.82895,44.48684 -12.35745,40.60307 -9.5329,69.55483 -6.00219,49.42982 -1.05921,46.2522 z',
];

// Biceps - Brachioradialis
const PATHS_BRACHIORADIALIS = [
  'm 948.34649,881.9693 -5.29605,42.36842 25.06798,155.70398 10.94518,-62.1404 11.65131,-64.25875 16.24119,-54.37281 2.8246,-38.13158 -3.5307,-55.07895 -8.82675,-33.54166 -34.24781,-40.60308 2.82456,28.95176 -4.94298,44.83991 -10.23904,43.42763 z',
  'm 306.81798,773.22369 7.76755,24.71491 15.18201,29.65789 11.29825,27.53948 1.05921,14.82894 -26.48026,32.48246 -9.5329,48.37061 -50.48903,105.56802 -18.35965,10.5921 -15.18202,3.5307 13.41667,-56.1382 7.0614,-41.66227 8.82676,-68.49561 10.5921,-39.19079 17.30044,-34.95395 19.41886,-31.77631 z',
];

// Quadriceps - Rectus Femoris
const PATHS_RECTUS_FEMORIS = [
  'm 718.49781,1088.1623 -10.59211,48.7237 -22.94956,109.4517 -5.64912,49.0768 0.70614,21.1842 14.12281,57.5504 20.47807,64.6119 17.30043,43.0745 2.82457,13.4167 8.82675,-3.5307 8.82676,5.6491 -1.76536,-20.4781 6.35527,-79.7938 9.17982,-86.5022 2.82456,-45.5461 -8.12061,-50.489 -26.48026,-68.1425 z',
  'm 461.86788,1499.9472 0.49932,-73.3996 1.99727,-43.4405 4.49385,-54.4255 14.48018,-64.9112 -18.97403,-82.3873 -14.9795,-95.8687 -10.98497,14.9795 -34.95216,85.8824 -6.99044,72.9002 8.9877,86.8811 26.9631,96.8675 z',
];

// Quadriceps - Vastus Group
const PATHS_VASTUS_GROUP = [
  'm 437.80702,1559.864 12.71052,-31.7763 -2.11842,-52.2544 -15.71162,-32.3059 -27.00987,-96.7412 -9.53289,-88.091 7.59101,-73.9682 34.95394,-85.443 10.23904,-13.9463 16.06469,97.977 18.34508,80.0812 -13.73121,63.7877 -6.99043,99.364 -0.49932,72.9002 16.29255,61.4754 21.89035,36.0132 16.5943,17.6535 21.18421,-8.4737 11.16934,-11.2989 40.19499,21.97 2.9959,-47.9344 0.24966,-54.9249 20.47198,-103.3585 9.73668,-58.9194 -1.24829,-47.4351 -8.48839,-56.1731 -13.48155,-30.708 c 0,0 -9.48701,3.4953 -11.23462,2.9959 -1.74761,-0.4993 -16.22779,-6.9904 -16.22779,-6.9904 l -16.47745,-20.2223 -14.48018,-32.7052 -20.9713,-33.4543 -56.9221,-67.158 -22.7189,-27.2128 -8.73804,-13.7312 -16.22779,47.4351 -15.47882,101.8606 -14.9795,85.8824 -2.24692,59.918 1.24829,59.4187 12.23326,78.6424 16.22779,50.6806 z',
  'm 768.07381,1532.5276 -12.98223,-19.5982 -2.87107,-15.7285 -1.62278,-20.9713 3.8697,-46.6861 4.74351,-56.7973 6.24146,-55.2993 3.49521,-52.6779 -8.23872,-50.9303 -26.21412,-66.6587 -15.85331,-58.6697 -30.33348,141.4314 -8.23873,53.9262 v 32.4556 l 14.72984,58.7945 19.97267,63.7877 17.47608,42.6916 2.74624,13.7312 1.51031,58.8864 -7.06141,57.1974 -14.82894,5.6491 -27.89255,-28.9517 -13.76973,-36.0132 -12.71053,-52.9605 -3.88377,-45.193 -11.29825,-52.2544 -22.59649,-96.7412 -9.35636,-58.6097 -2.47149,-38.3081 -2.11842,-37.0724 11.65131,-29.6579 33.1886,-40.4265 30.54057,-42.3684 33.89474,-28.0691 49.07675,-37.95504 27.85641,-27.92536 5.118,10.6729 10.10015,24.8435 11.65132,35.307 10.76864,49.2533 5.82566,47.3114 4.76645,58.08 0.17653,22.42 12.19781,65.8076 5.80877,61.4742 0.88268,56.3147 -3.35417,57.5504 -8.29715,74.8509 -11.01826,45.9045 -26.9631,22.4693 -31.95627,-27.9617 z',
];

// Forearms - Flexors only
const PATHS_FLEXORS = [
  'm 257.03509,1056.386 36.7193,55.7851 26.12719,-50.8422 40.95614,-61.0811 13.0636,-20.83113 19.41886,-49.7829 9.17982,-41.66228 2.82456,-22.94956 -26.83333,-16.24123 -34.24781,24.00878 -28.95175,29.30482 -9.88597,50.48903 z',
  'm 898.21053,825.125 30.7171,22.59649 19.41886,32.12939 -5.64912,43.07456 25.77412,156.41006 -2.47149,31.4233 -11.29824,-1.4123 -11.65132,-55.079 -22.59649,-71.32013 -11.29825,-35.66009 -5.29605,-68.14254 z',
];

// Forearms - Extensors only
const PATHS_EXTENSORS = [
  'm 967.76535,1077.9232 15.18202,47.6645 57.55043,6.3553 0.3531,-64.9649 11.6513,-99.91889 v -40.25 l -7.0614,-40.95614 -9.886,-41.66228 -13.0636,-38.83772 -23.65567,-28.95175 7.76757,28.95175 2.4715,35.66009 v 36.36623 l -1.4123,22.59649 -16.24125,50.8421 z',
];

function MuscleGroup({ paths, fill, fillActive, onPress }: MuscleGroupProps) {
  const glowAnim = useRef(new Animated.Value(0)).current;
  const isPressed = useRef(false);

  const handleGrant = () => {
    isPressed.current = true;
    Animated.timing(glowAnim, {
      toValue: 1,
      duration: 200,
      useNativeDriver: false,
    }).start();
  };

  const handleRelease = () => {
    if (!isPressed.current) return;
    isPressed.current = false;

    // Biraz daha parlak kalsın, sonra hareketleri göster.
    Animated.timing(glowAnim, {
      toValue: 1,
      duration: 80,
      useNativeDriver: false,
    }).start();

    setTimeout(() => {
      onPress();
      Animated.timing(glowAnim, {
        toValue: 0,
        duration: 250,
        useNativeDriver: false,
      }).start();
    }, 150);
  };

  const handleTerminate = () => {
    isPressed.current = false;
    Animated.timing(glowAnim, {
      toValue: 0,
      duration: 200,
      useNativeDriver: false,
    }).start();
  };

  return (
    <G
      onStartShouldSetResponder={() => true}
      onResponderGrant={handleGrant}
      onResponderRelease={handleRelease}
      onResponderTerminate={handleTerminate}
    >
      {paths.map((d, i) => (
        <React.Fragment key={i}>
          {/* Base hit area (neredeyse görünmez) */}
          <Path d={d} fill={fill} />
          {/* Active overlay (parlak renk) */}
          <AnimatedPath
            d={d}
            fill={fillActive}
            opacity={glowAnim}
            stroke={fillActive}
            strokeWidth={1.5}
            strokeOpacity={glowAnim}
          />
        </React.Fragment>
      ))}
    </G>
  );
}

export default function AnatomySvgFront({
  onSelectRegion,
  detailMode = 'simple',
}: Props) {
  const isDetailed = detailMode === 'detailed';

  return (
    <View style={styles.container}>
      <Svg width={280} height={580} viewBox="0 0 1246 2415">
        {/* PNG tabanı */}
        <SvgImage
          href={FRONT_BASE}
          x={0}
          y={0}
          width={1246}
          height={2415}
          preserveAspectRatio="xMidYMid meet"
        />

        {/* Etkileşimli kas bölgeleri */}

        {/* Trapezius (üst) - her iki modda da aynı */}
        <MuscleGroup
          paths={PATHS_TRAPS}
          fill="#ffffff01"
          fillActive="#eab30880"
          onPress={() => onSelectRegion?.({ keyword: 'Back', label: 'Trapez' })}
        />

        {/* Omuz */}
        {isDetailed ? (
          <>
            <MuscleGroup
              paths={PATHS_FRONT_SHOULDER}
              fill="#ffffff01"
              fillActive="#3b82f680"
              onPress={() =>
                onSelectRegion?.({ keyword: 'Front Shoulder', label: 'Ön Omuz' })
              }
            />
            <MuscleGroup
              paths={PATHS_LATERAL_SHOULDER}
              fill="#ffffff01"
              fillActive="#60a5fa80"
              onPress={() =>
                onSelectRegion?.({ keyword: 'Lateral Shoulder', label: 'Yan Omuz' })
              }
            />
          </>
        ) : (
          <MuscleGroup
            paths={PATHS_SHOULDERS}
            fill="#ffffff01"
            fillActive="#3b82f680"
            onPress={() => onSelectRegion?.({ keyword: 'Shoulder', label: 'Omuz' })}
          />
        )}

        {/* Göğüs */}
        {isDetailed ? (
          <>
            <MuscleGroup
              paths={PATHS_UPPER_CHEST}
              fill="#ffffff01"
              fillActive="#ef444480"
              onPress={() =>
                onSelectRegion?.({ keyword: 'Upper Chest', label: 'Üst Göğüs' })
              }
            />
            <MuscleGroup
              paths={PATHS_MIDDLE_LOWER_CHEST}
              fill="#ffffff01"
              fillActive="#f87171a0"
              onPress={() =>
                onSelectRegion?.({
                  keyword: 'Middle & Lower Chest',
                  label: 'Orta & Alt Göğüs',
                })
              }
            />
          </>
        ) : (
          <MuscleGroup
            paths={PATHS_CHEST}
            fill="#ffffff01"
            fillActive="#ef444480"
            onPress={() => onSelectRegion?.({ keyword: 'Chest', label: 'Göğüs' })}
          />
        )}

        {/* Triseps - sadece basit modda görünsün (ön görünümde küçük) */}
        {!isDetailed && (
          <MuscleGroup
            paths={PATHS_TRICEPS}
            fill="#ffffff01"
            fillActive="#fbbf2480"
            onPress={() => onSelectRegion?.({ keyword: 'Triceps', label: 'Triseps' })}
          />
        )}

        {/* Biseps */}
        {isDetailed ? (
          <>
            <MuscleGroup
              paths={PATHS_BICEPS_LONG}
              fill="#ffffff01"
              fillActive="#a855f780"
              onPress={() =>
                onSelectRegion?.({
                  keyword: 'Biceps Long Head',
                  label: 'Biseps (Uzun Baş)',
                })
              }
            />
            <MuscleGroup
              paths={PATHS_BICEPS_SHORT}
              fill="#ffffff01"
              fillActive="#c084fc80"
              onPress={() =>
                onSelectRegion?.({
                  keyword: 'Biceps Short Head',
                  label: 'Biseps (Kısa Baş)',
                })
              }
            />
            <MuscleGroup
              paths={PATHS_BRACHIORADIALIS}
              fill="#ffffff01"
              fillActive="#d8b4fe80"
              onPress={() =>
                onSelectRegion?.({ keyword: 'Brachioradialis', label: 'Brachioradialis' })
              }
            />
          </>
        ) : (
          <MuscleGroup
            paths={PATHS_BICEPS}
            fill="#ffffff01"
            fillActive="#a855f780"
            onPress={() => onSelectRegion?.({ keyword: 'Biceps', label: 'Biseps' })}
          />
        )}

        {/* Ön Kol */}
        {isDetailed ? (
          <>
            <MuscleGroup
              paths={PATHS_FLEXORS}
              fill="#ffffff01"
              fillActive="#a855f780"
              onPress={() =>
                onSelectRegion?.({ keyword: 'Flexors', label: 'Ön Kol (Flexors)' })
              }
            />
            <MuscleGroup
              paths={PATHS_EXTENSORS}
              fill="#ffffff01"
              fillActive="#c084fc80"
              onPress={() =>
                onSelectRegion?.({ keyword: 'Extensors', label: 'Ön Kol (Extensors)' })
              }
            />
          </>
        ) : (
          <MuscleGroup
            paths={PATHS_FOREARMS}
            fill="#ffffff01"
            fillActive="#a855f780"
            onPress={() => onSelectRegion?.({ keyword: 'Forearms', label: 'Ön Kol' })}
          />
        )}

        {/* Karın */}
        {isDetailed ? (
          <>
            <MuscleGroup
              paths={PATHS_UPPER_ABS}
              fill="#ffffff01"
              fillActive="#f9731680"
              onPress={() =>
                onSelectRegion?.({ keyword: 'Upper Abs', label: 'Üst Karın' })
              }
            />
            <MuscleGroup
              paths={PATHS_LOWER_ABS}
              fill="#ffffff01"
              fillActive="#fb923c80"
              onPress={() =>
                onSelectRegion?.({ keyword: 'Lower Abs', label: 'Alt Karın' })
              }
            />
          </>
        ) : (
          <MuscleGroup
            paths={PATHS_ABS}
            fill="#ffffff01"
            fillActive="#f9731680"
            onPress={() => onSelectRegion?.({ keyword: 'Abs', label: 'Karın' })}
          />
        )}

        {/* Yan Karın (Obliques) - her iki modda da aynı */}
        <MuscleGroup
          paths={PATHS_OBLIQUES}
          fill="#ffffff01"
          fillActive="#f9731680"
          onPress={() => onSelectRegion?.({ keyword: 'Obliques', label: 'Yan Karın' })}
        />

        {/* Quadriceps */}
        {isDetailed ? (
          <>
            <MuscleGroup
              paths={PATHS_RECTUS_FEMORIS}
              fill="#ffffff01"
              fillActive="#00d4aa80"
              onPress={() =>
                onSelectRegion?.({ keyword: 'Rectus Femoris', label: 'Rectus Femoris' })
              }
            />
            <MuscleGroup
              paths={PATHS_VASTUS_GROUP}
              fill="#ffffff01"
              fillActive="#34d39980"
              onPress={() =>
                onSelectRegion?.({ keyword: 'Vastus Group', label: 'Vastus Grubu' })
              }
            />
          </>
        ) : (
          <MuscleGroup
            paths={PATHS_QUADRICEPS}
            fill="#ffffff01"
            fillActive="#00d4aa80"
            onPress={() =>
              onSelectRegion?.({ keyword: 'Quadriceps', label: 'Ön Bacak' })
            }
          />
        )}

        {/* Baldır - her iki modda da aynı */}
        <MuscleGroup
          paths={PATHS_CALVES}
          fill="#ffffff01"
          fillActive="#00d4aa80"
          onPress={() => onSelectRegion?.({ keyword: 'Calves', label: 'Baldır' })}
        />
      </Svg>
    </View>
  );
}

const styles = StyleSheet.create({
  container: {
    alignItems: 'center',
  },
});
